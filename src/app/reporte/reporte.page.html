<ion-content class="report-content">

  <div class="bubbles">
    <span></span><span></span><span></span><span></span><span></span>
    <span></span><span></span><span></span><span></span><span></span>
  </div>

  <div class="report-card">
    <p class="register-text">
      ¿Deseas regresar?
      <a (click)="navigateBack()">Volver al menú</a>
    </p>

    <picture>
      <source media="(min-width:1024px)" srcset="assets/LOGO SPEIRA ESCRITORIO.png" />
      <img src="assets/LOGO SPEIRA.png" alt="Speira Logo" class="report-logo" />
    </picture>

    <h2 class="report-title">Generar Reporte</h2>
    <p class="report-subtitle">Selecciona los parámetros del reporte</p>

    <form class="report-form">

      <!-- Estanque -->
      <ion-item class="form-item" lines="none">
        <ion-label position="stacked" class="input-label">Seleccionar Unidad</ion-label>

        <ion-select [(ngModel)]="estanqueSeleccionado" name="estanque" class="form-input" interface="popover"
          [disabled]="estanquesDisponibles.length === 0 || estanquesDisponibles[0] === 'No hay unidades disponibles' || estanquesDisponibles[0] === 'Error al cargar unidades'"
          placeholder="Seleccione una unidad">

          <ion-select-option *ngFor="let estanque of estanquesDisponibles" [value]="estanque"
            [disabled]="estanque === 'No hay unidades disponibles' || estanque === 'Error al cargar unidades'">
            {{ estanque }}
          </ion-select-option>

        </ion-select>
      </ion-item>

      <!-- Mensaje de estado cuando no hay unidades o error -->
      <ion-item lines="none"
        *ngIf="estanquesDisponibles.length > 0 && (estanquesDisponibles[0] === 'No hay unidades disponibles' || estanquesDisponibles[0] === 'Error al cargar unidades')">
        <ion-label [color]="estanquesDisponibles[0] === 'Error al cargar unidades' ? 'danger' : 'warning'">
          <ion-icon [name]="estanquesDisponibles[0] === 'Error al cargar unidades' ? 'alert-circle' : 'warning'"
            slot="start">
          </ion-icon>
          {{ estanquesDisponibles[0] }}
        </ion-label>
      </ion-item>

      <!-- Loading state (opcional, si agregas variable de loading) -->
      <ion-item lines="none" *ngIf="!estanquesDisponibles.length">
        <ion-label color="medium">
          <ion-spinner name="dots" slot="start"></ion-spinner>
          Cargando unidades disponibles...
        </ion-label>
      </ion-item>

      <!-- Periodo -->
      <ion-item class="form-item" lines="none">
        <ion-label position="floating" class="input-label">Periodo</ion-label>
        <ion-select [(ngModel)]="periodo" name="periodo" interface="popover" class="form-input">
          <ion-select-option value="diario">Diario</ion-select-option>
          <ion-select-option value="semanal">Semanal</ion-select-option>
          <ion-select-option value="mensual">Mensual</ion-select-option>
          <ion-select-option value="anual">Anual</ion-select-option>
        </ion-select>
      </ion-item>

      <!-- Fecha dinámica -->
      <ion-item class="form-item" lines="none" *ngIf="periodo">
        <ion-label position="floating" class="input-label">Fecha</ion-label>
        <ion-datetime [(ngModel)]="fechaSeleccionada" name="fechaSeleccionada"
          [presentation]="obtenerPresentacionFecha()" class="form-input">
        </ion-datetime>
      </ion-item>

      <div class="divider"></div>

      <ion-button expand="block" class="report-button" (click)="generarReporte()" [disabled]="generando">
        <ion-spinner *ngIf="generando" name="crescent" slot="start"></ion-spinner>
        {{ generando ? 'Generando...' : 'GENERAR REPORTE' }}
      </ion-button>
    </form>
  </div>

</ion-content>